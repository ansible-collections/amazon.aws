---
- hosts: 127.0.0.1
  connection: local
  gather_facts: false
  tasks:
    - name: assert cache was used to populate inventory
      ansible.builtin.assert:
        that:
          - "'aws_ec2' in groups"
          - groups.aws_ec2 | length > 0

    - ansible.builtin.meta: refresh_inventory
    - name: assert refresh_inventory updated the cache
      ansible.builtin.assert:
        that:
          - "'aws_ec2' in groups"
          - not groups.aws_ec2
