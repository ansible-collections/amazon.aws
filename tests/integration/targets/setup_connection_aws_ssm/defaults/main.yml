---
instance_type: t3.micro

ami_details:
    fedora:
        owner: 125523088429
        name: Fedora-Cloud-Base-34-1.2.x86_64*
        user_data: |
            #!/bin/sh
            sudo dnf install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm
            sudo systemctl start amazon-ssm-agent
        os_type: linux
    amazon:
        owner: amazon
        name: amzn2-ami-kernel-5.10-hvm-*-x86_64-gp2
        user_data: |
            #!/bin/sh
            # Pre-Installed just needs started
            sudo systemctl start amazon-ssm-agent
        os_type: linux
    ubuntu:
        owner: amazon
        name: ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server*
        user_data: |
            #!/bin/sh
            # Pre-Installed just needs started
            sudo systemctl start amazon-ssm-agent
        os_type: linux
    windows:
        owner: amazon
        name: Windows_Server-2022-English-Full-Base-*
        user_data: |
            <powershell>
            Invoke-WebRequest -Uri "https://amazon-ssm-us-east-1.s3.amazonaws.com/latest/windows_amd64/AmazonSSMAgentSetup.exe" -OutFile "C:\AmazonSSMAgentSetup.exe"
            Start-Process -FilePath C:\AmazonSSMAgentSetup.exe -ArgumentList "/S","/v","/qn" -Wait
            Restart-Service AmazonSSMAgent
            </powershell>
        os_type: windows

# see:
# - https://github.com/mattclay/aws-terminator/pull/181
# - https://github.com/ansible-collections/community.aws/pull/763
encrypted_s3_bucket_name: ssm-encrypted-test-bucket

s3_bucket_name: "{{ resource_prefix }}-connection-ssm"
kms_key_name: "{{ resource_prefix }}-connection-ssm"
