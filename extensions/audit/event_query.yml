---
amazon.aws.elb_application_lb_info:
  query: >-
    .load_balancers[] | select(. != null) |
    {
      canonical_facts: {
        name: .load_balancer_name,
        arn: (.load_balancer_arn // null),
        dns_name: (.dns_name // null),
        vpc_id: (.vpc_id // null),
        tags: (.tags // {})
      },
      facts: {
        infra_type: "PublicCloud",
        infra_bucket: "Networking",
        device_type: "ApplicationLoadBalancer"
      },
      extra_fields: {
      scheme: (.scheme // null),
      availability_zones: (.availability_zones // []),
      security_groups: (.security_groups // []),
      subnets: (.subnets // [])
      }
    }

amazon.aws.elb_classic_lb_info:
  query: >-
    .elbs[] | select(. != null) |
    {
      canonical_facts: {
        name: .load_balancer_name,
        dns_name: (.dns_name // null),
        vpc_id: (.vpc_id // null),
        tags: (.tags // {})
      },
      facts: {
        infra_type: "PublicCloud",
        infra_bucket: "Networking",
        device_type: "ClassicLoadBalancer"
      },
      extra_fields: {
        scheme: (.scheme // null),
        availability_zones: (.availability_zones // []),
        security_groups: (.security_groups // []),
        subnets: (.subnets // [])
      }
    }

amazon.aws.s3_bucket_info:
  query: >-
    .buckets[] | select(. != null) |
    {
      canonical_facts: {
        name: .name,
        tags: (.bucket_tagging // {})
      },
      facts: {
        infra_type: "PublicCloud",
        infra_bucket: "Storage",
        device_type: "Bucket"
      }
    }

amazon.aws.s3_object_info:
  query: >-
    .object_info[] | select(. != null) |
    {
      canonical_facts: {
        name: .object_name,
        tags: (.object_tagging // {})
      },
      facts: {
        infra_type: "PublicCloud",
        infra_bucket: "Storage",
        device_type: "Object"
      }
    }